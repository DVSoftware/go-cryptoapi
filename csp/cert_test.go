package csp

import (
	//"fmt"
	"bytes"
	"encoding/base64"
	"github.com/stretchr/testify/assert"
	"testing"
)

var certData = `MIIDejCCAymgAwIBAgIKPWwmFQACAAcKtDAIBgYqhQMCAgMwZTEgMB4GCSqGSIb3
DQEJARYRaW5mb0BjcnlwdG9wcm8ucnUxCzAJBgNVBAYTAlJVMRMwEQYDVQQKEwpD
UllQVE8tUFJPMR8wHQYDVQQDExZUZXN0IENlbnRlciBDUllQVE8tUFJPMB4XDTE0
MDQwNjIwNDAxMFoXDTE0MTAwNDA3MDk0MVowgZwxTDBKBgNVBAMMQ9Ci0LXRgdGC
0L7QstGL0Lkg0YHQtdGA0LLQtdGAINGN0LvQtdC60YLRgNC+0L3QvdC+0Lkg0L/Q
vtC00L/QuNGB0LgxFjAUBgUqhQNkAxILMDAwMDAwMDAwMDAxGDAWBgUqhQNkARIN
MDAwMDAwMDAwMDAwMDEaMBgGCCqFAwOBAwEBEgwwMDAwMDAwMDAwMDAwYzAcBgYq
hQMCAhMwEgYHKoUDAgIkAAYHKoUDAgIeAQNDAARA0qygLELcRS3lt6FshfFk+ywp
z5F4VmXe+5VSuiI95bXKy4S3aBr5ss+DNJQzaRW8/joA0sUY+Tb/1PD9iUru3KOC
AX8wggF7MAsGA1UdDwQEAwIE8DAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUH
AwQwEwYDVR0gBAwwCjAIBgYqhQNkcQEwHQYDVR0OBBYEFG39dFimoBKfTaL8Zcav
bxsXBV8YMB8GA1UdIwQYMBaAFG2PXgXZX6yRF5QelZoFMDg3ehAqMFUGA1UdHwRO
MEwwSqBIoEaGRGh0dHA6Ly93d3cuY3J5cHRvcHJvLnJ1L0NlcnRFbnJvbGwvVGVz
dCUyMENlbnRlciUyMENSWVBUTy1QUk8oMikuY3JsMIGgBggrBgEFBQcBAQSBkzCB
kDAzBggrBgEFBQcwAYYnaHR0cDovL3d3dy5jcnlwdG9wcm8ucnUvb2NzcG5jL29j
c3Auc3JmMFkGCCsGAQUFBzAChk1odHRwOi8vd3d3LmNyeXB0b3Byby5ydS9DZXJ0
RW5yb2xsL3BraS1zaXRlX1Rlc3QlMjBDZW50ZXIlMjBDUllQVE8tUFJPKDIpLmNy
dDAIBgYqhQMCAgMDQQCY8/Z3naFUMMZ+KkKD1X1nplIKPpY+8y1WCv/eVkcl2pA3
i3nzFcXpd9uj6plPRpuVbPkbDc8iq8Y9pbUg85dJ`

func TestNewCert(t *testing.T) {
	certRdr := base64.NewDecoder(base64.StdEncoding, bytes.NewReader(([]byte)(certData)))
	crt, err := NewCert(certRdr)
	assert.NoError(t, err)
	assert.NotNil(t, crt.pcert)
	assert.NoError(t, crt.Close())
}
